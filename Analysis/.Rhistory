melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#3590ae", "blue")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
Colors=c("white", "light blue", "blue")
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
#original
Colors=c("white", "#ff9999", "#800000")
Colors=c("white", "light blue", "blue")
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "light blue", "blue")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
Colors=c("light blue", "#3590ae", "blue")
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("light blue", "#3590ae", "blue")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("#e6ffff", "#3590ae", "blue")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("#e6ffff", "light blue", "#3590ae")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("#e6ffff", "light blue", "#3590ae")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("#e6ffff", "light blue", "#3590ae")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "light blue", "#3590ae")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE, sepList = c(50,50), sep.color = c("gray45", "gray45"), sep.lty = 5, sep.lwd = 5,
margins=c(1,1))
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "light blue", "#3590ae")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Label =
c('red','red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Label =
c('red','red','red','red','red','red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green','green',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Label =
c('red','red','red','red','red','red','red','red','red','red','red',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#C9D6F8", "#0D2CB4")
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Colors=colorRampPalette(Colors)(255)
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#C9D6F8", "#0D2CB4")
Colors=colorRampPalette(Colors)(255)
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#FFB7B5", "#B81312")
Colors=colorRampPalette(Colors)(255)
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#B5FFB8", "#2FAC52")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red','red',
'red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
library(RColorBrewer)
library(reshape2)
library(heatmap3)
###ALL###
#data
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop20.csv", header=T,	row.names=1,sep=",")
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv", header=T,	row.names=1,sep=",")
virusmatrix = t(virusmatrix)
virusmatrix<-as.matrix(virusmatrix)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# collapse the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
Colors=c("white", "#66d16b", "#2FAC52")
Colors=colorRampPalette(Colors)(255)
Label =
c('red','red','red','red','red','red','red','red','red','red','red',
'red','red','red','red','red','red',
'green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green','green',
'light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue','light blue')
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
Colors=c("white", "#66d16b", "#089930")
#virus
Colors=c("white", "red", "#800000")
Colors=c("white", "#66d16b", "#089930")
Colors=colorRampPalette(Colors)(255)
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
# The following initializes usage of Bioc devel
BiocManager::install(version='devel')
BiocManager::install("sangeranalyseR")
library(ggplot2)
library(RColorBrewer)
meta_data = read.table(
"../Data/Top40analysis.csv"
, header=T, stringsAsFactors=FALSE, sep=",")
setwd("~/Code/Neisseria/Analysis")
library(ggplot2)
library(RColorBrewer)
meta_data = read.table(
"../Data/Top40analysis.csv"
, header=T, stringsAsFactors=FALSE, sep=",")
meta_data = read.table(
"../Data/Figure_7"
, header=T, stringsAsFactors=FALSE, sep=",")
meta_data = read.table(
"../Data/Figure_7/Top40analysis.csv"
, header=T, stringsAsFactors=FALSE, sep=",")
meta_data <- subset(meta_data, Disease != "Blank")
meta_data <- melt(meta_data)
library(tidyverse)
meta_data <- melt(meta_data)
library(reshape2)
meta_data <- melt(meta_data)
meta_data$Disease <- factor(meta_data$Disease, levels=c("ND", "BE", "SA", "COPD"))
meta_data$Geo.Origin <- factor(meta_data$Geo.Origin, levels=c("SG-KL", "DD"))
levels(meta_data$variable)<-
c("Neisseria meningitidis",
"Neisseria flavescens",
"Neisseria subflava",
"Neisseria lactamica",
"Neisseria sicca",
"Neisseria gonorrhoeae",
"Rothia mucilaginosa",
"Streptococcus pneumoniae",
"Streptococcus mitis",
"Prevotella melaninogenica",
"Pseudomonas aeruginosa",
"Streptococcus parasanguinis",
"Haemophilus influenzae",
"Actinomyces odontolyticus",
"Veillonella parvula",
"Toxoplasma gondii",
"Streptococcus thermophilus",
"Streptococcus salivarius",
"Malassezia globosa",
"Streptococcus oralis",
"Streptococcus sanguinis",
"Streptococcus infantis",
"Streptococcus gordonii",
"Streptococcus sp. M143",
"Veillonella dispar",
"Rothia dentocariosa",
"Gemella haemolysans",
"Granulicatella adiacens",
"Drosophila willistoni",
"Veillonella atypica",
"Kocuria rhizophila",
"Fusobacterium nucleatum",
"Prevotella veroralis",
"Arthrobacter sp. FB24",
"Arthrobacter aurescens",
"Prevotella oris",
"Porphyromonas gingivalis",
"Actinomyces viscosus",
"Prevotella tannerae",
"Leptotrichia buccalis",
"Other"
)
Dis.grps<-ggplot(data=meta_data,aes(x=Disease, y=value, fill=variable))+
geom_bar(aes(), stat="identity", position = "fill") +
scale_fill_manual(values = c("#ff3333","#900D03", "#E3242B", "#B90E0A", "#ff9999","#BC544B",
"darkblue", "darkgoldenrod1", "darkseagreen", "darkorchid", "darkolivegreen1",
"lightskyblue", "darkgreen", "deeppink", "khaki2", "firebrick", "brown1",
"darkorange1", "cyan1", "royalblue4", "darksalmon", "brown4", "royalblue3",
"dodgerblue3", "steelblue1", "lightskyblue", "darkseagreen1", "darkgoldenrod3",
"darkseagreen2", "darkorchid3", "darkolivegreen2", "brown3", "darkorange3", "cyan3",
"darkseagreen3", "darkblue", "darkgoldenrod4", "darkseagreen2", "darkorchid1",
"darkolivegreen2", "grey" )) +
scale_y_continuous(labels = scales::percent)+
theme(legend.position="right",
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(angle = 90),
panel.background = element_rect(fill = NA),
axis.line = element_line(size = 0.5, colour = "black"),
legend.title = element_blank(),
legend.text = element_text(face = "italic")) +
guides(fill=guide_legend(ncol=2), size = .1)+
xlab("")+
ylab("Relative abundance")+
facet_wrap(~meta_data$Geo.Origin, scales="free_x")+
theme(
strip.background = element_rect(
color="white", fill="white", size=1, linetype="solid"),
strip.text.x = element_text(size = 12)
)
ggplot(data=meta_data,aes(x=Disease, y=value, fill=variable))+
geom_bar(aes(), stat="identity", position = "fill") +
scale_fill_manual(values = c("#ff3333","#900D03", "#E3242B", "#B90E0A", "#ff9999","#BC544B",
"darkblue", "darkgoldenrod1", "darkseagreen", "darkorchid", "darkolivegreen1",
"lightskyblue", "darkgreen", "deeppink", "khaki2", "firebrick", "brown1",
"darkorange1", "cyan1", "royalblue4", "darksalmon", "brown4", "royalblue3",
"dodgerblue3", "steelblue1", "lightskyblue", "darkseagreen1", "darkgoldenrod3",
"darkseagreen2", "darkorchid3", "darkolivegreen2", "brown3", "darkorange3", "cyan3",
"darkseagreen3", "darkblue", "darkgoldenrod4", "darkseagreen2", "darkorchid1",
"darkolivegreen2", "grey" )) +
scale_y_continuous(labels = scales::percent)+
theme(legend.position="right",
axis.text=element_text(size=14),
axis.title=element_text(size=14),
axis.text.x = element_text(angle = 90),
panel.background = element_rect(fill = NA),
axis.line = element_line(size = 0.5, colour = "black"),
legend.title = element_blank(),
legend.text = element_text(face = "italic")) +
guides(fill=guide_legend(ncol=2), size = .1)+
xlab("")+
ylab("Relative abundance")+
facet_wrap(~meta_data$Geo.Origin, scales="free_x")+
theme(
strip.background = element_rect(
color="white", fill="white", size=1, linetype="solid"),
strip.text.x = element_text(size = 12)
)
